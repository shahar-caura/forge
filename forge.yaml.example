# Forge configuration
# Copy to forge.yaml and fill in values.
# Environment variables are resolved at load time: ${VAR_NAME}

vcs:
  provider: github
  repo: owner/repo          # GitHub owner/repo
  base_branch: main         # Branch to create PRs against

tracker:
  provider: jira
  project: PROJ             # Jira project key
  base_url: ${JIRA_URL}     # e.g. https://yourco.atlassian.net
  email: ${JIRA_EMAIL}
  token: ${JIRA_TOKEN}
  # board_id: "123"         # Optional: Jira board ID

notifier:
  provider: slack
  webhook_url: ${SLACK_WEBHOOK_URL}

agent:
  provider: claude          # claude, ralph, codex, gemini
  timeout: 45m              # Max time for agent execution
  # providers:              # Optional: multi-agent pool for batch runs (round-robin + fallback).
  #   - claude              # When set, overrides provider for batch; provider is still used
  #   - gemini              # for single runs (forge run) and as default if providers is empty.
  # allowed_tools: ""       # Optional: comma-separated tool allowlist (auto-set for ralph)

worktree:
  create_cmd: "./scripts/git-worktree-add.sh {{.Branch}} {{.Path}} {{.BaseBranch}}"
  remove_cmd: "git worktree remove --force {{.Path}}"
  cleanup: true             # Remove worktree after PR is opened
  cleanup_on_merge: false   # Automatically remove worktree when PR is merged

hooks:
  pre_commit: "make fmt && make vet"  # Run before pushing commits
  max_hook_retries: 2                 # Agent retry attempts on hook failure (0 = fail fast)

state:
  retention: 168h             # How long to keep completed run states (7 days)

cr:
  enabled: false              # Set to true to enable CR feedback loop
  # mode: poll                # "poll" (external GitHub Action) or "local" (agent-based review)
  # max_rounds: 2             # Review-fix iterations for local mode
  # agent: claude             # Agent override for CR review (defaults to agent.provider)
  # poll_timeout: 5m          # How long to wait for a CR comment (poll mode)
  # poll_interval: 15s        # How often to poll for comments (poll mode)
  # comment_pattern: ""       # Regex to match CR bot comment (poll mode only)
  # fix_strategy: amend       # "amend" or "new-commit"

server:
  # port: 8080               # Dashboard HTTP server port

editor:
  enabled: false              # Open editor automatically on forge edit
  command: code               # Editor command (forge edit)
